package server

import (
	"net/http"

	messages "github.com/delineateio/mimas/messages"
	"github.com/jinzhu/gorm"
)

// Customer represents a customer within this specific domain
type Customer struct {
	gorm.Model
	Forename string `json:"forename" binding:"required"`
	Surname  string `json:"surname" binding:"required"`
}

func addCustomer(request *messages.Request, response *messages.Response) {
	customer := Customer{}
	err := request.Translate(&customer)
	if err != nil {
		response.Code = http.StatusBadRequest
		return
	}
	err = NewCustomerRepository().CreateCustomer(&customer)
	if err != nil {
		response.Code = http.StatusServiceUnavailable
		return
	}
	response.Code = http.StatusCreated
}
